# ファイル名: sha256_hash_example.rb

# SHA256による暗号学的ハッシュ関数の実行例
# ------------------------------------------------------------
# SHA-256 は「暗号学的ハッシュ関数」の一種で、
# - 任意長の入力データを固定長（256ビット = 64桁の16進数）の値に写像する
# - 入力が少し変わるだけで、出力が大きく変化する（アバランシェ効果）
# - ハッシュ値から元の入力を推測することが極めて難しい（前像計算困難性）
# - 同じハッシュ値をとる別の入力を見つけることが極めて難しい（衝突困難性）
#
# ブロックチェーンでは主に以下の用途で使われる：
# - ブロックヘッダのハッシュ：ブロック全体の「要約」として働き、改ざん検出の基盤となる
# - トランザクションID：トランザクションの内容に基づく一意な識別子として利用される
# - PoW（Proof of Work）：ハッシュ値が特定の条件（先頭に0がいくつ並ぶ等）を満たすまで
#   ノンスを変えながらハッシュ計算を繰り返すことで「計算作業量」を証明する

require 'digest'

# 例として、2つの非常に似た入力文字列を用意する
value1 = "12345"
value2 = "12346"  # 最後の1文字だけ異なる

# Digest::SHA256.hexdigest は、与えた文字列を SHA-256 でハッシュし、
# その結果を16進数の文字列（64桁）として返すメソッドである。
hash1 = Digest::SHA256.hexdigest(value1)
hash2 = Digest::SHA256.hexdigest(value2)

# 結果の表示
# 入力が1文字違うだけだが、出力のハッシュ値はほぼ無関係なランダム値に見える。
# これがアバランシェ効果であり、ブロックチェーンにおいて
# 「少しでも内容を改ざんするとハッシュが完全に変わる」性質を保証している。
puts "入力: #{value1}, SHA-256ハッシュ: #{hash1}"
# 期待される出力例:
# 入力: 12345, SHA-256ハッシュ: 5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5

puts "入力: #{value2}, SHA-256ハッシュ: #{hash2}"
# 期待される出力例:
# 入力: 12346, SHA-256ハッシュ: 34d128f5b3dede622e107438fbefabdf0519ebab21ac7b6f2075f974d09ce524

# まとめ：
# - SHA-256 のような暗号学的ハッシュ関数は、ブロックチェーンの安全性の根幹を支える要素であり、
#   データの「一方向な要約」を提供することで、改ざん検出や PoW に利用される。
# - この小さなサンプルは、その振る舞い（アバランシェ効果）と Ruby での利用方法を確認する最小例になっている。